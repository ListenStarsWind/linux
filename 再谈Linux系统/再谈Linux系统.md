[TOC]

# 再谈Linux系统

## 冯诺依曼体系

冯诺依曼体系是当今计算机的主流硬件组织形式。

![image-20241011103000970](https://md-wind.oss-cn-nanjing.aliyuncs.com/md/202410111030051.png)

简单来说，信息通过输入设备加载到存储器中，然后中央处理器对存储器上的信息进行操作，最后将修改后的信息输出到输出设备。从这一过程可以看出，存储器实际上指的是内存，因为我们在早期学习中了解到，CPU只能处理内存中的数据。因此，这里的存储器就是内存。而其他具有存储功能的设备，比如硬盘，通常作为输入输出设备使用。例如，在处理某个文件时，首先将硬盘上的文件加载到内存，此时硬盘充当输入设备；文件修改后，再将其写回硬盘，此时硬盘则作为输出设备。

计算机的存在归根结底是为了满足人类的需求，这意味着人和计算机之间必须进行一定程度的交互。由于人和计算机在物理结构上存在本质差异，他们对信息的处理方式也不同：人使用化学信号，而计算机使用电信号；显然，电信号的处理速度远快于化学信号。因此，人和计算机之间的信息转换必然需要一个过渡过程。最初，这一过程主要由人来承担，例如将信息翻译成二进制并在纸带上打孔，计算机再读取这些信息进行处理。

随着技术的发展，这种过渡过程逐渐转移到了计算机的职责上。现在，我们通过键盘输入字符信息，这些信息经过一系列用户无需关心的过程被传送到内存中供CPU处理，最终输出到显示屏或通过网卡进行网络传输等。这一变化大大降低了对用户的要求，使计算机的使用变得更加普及和便捷。

从上述描述中可以看出，输入输出设备主要用于实现人机交互，并非计算机的核心组成部分，因此被称为外设。外设讲的差不多了，那就要将计算机的核心部分了。

运算器，顾名思义，负责执行计算任务，主要包括两种类型的运算：算术运算（如加、减、乘、除）和逻辑运算（如真假判断）。控制器则负责管理计算过程中的硬件流程，例如，它协调运算器的操作、指令的获取与执行、以及数据在不同组件之间的传输。

上述五个组件：输入输出设备、存储器、运算器和控制器都是独立的。为了实现它们之间的信息流动，需要一种称为“总线”的连接方式，将各个组件联系起来。总线主要分为系统总线和I/O总线，前者负责连接CPU与内存，后者则用于连接输入输出设备。

冯诺依曼体系还规定了各组件之间的信息流向：数据信号只能从输入设备写入存储器。CPU在处理存储器中的信息后，才能将数据信号写入输出设备。换言之，数据信号是单向流动的。

## 存储金字塔

![1322310-20200328084130182-1706395900](https://md-wind.oss-cn-nanjing.aliyuncs.com/md/202410111206915.png)

存储是计算机不可避免的话题。尽管计算机以电信号处理信息，但对电信号的处理最终归结为实际的物理操作。由于计算机各种存储设备的物理结构差异，数据的读写效率也各不相同。一般而言，越靠近CPU的存储设备，其存储效率越高，因此单位存储容量的成本也越高。

CPU的速度极高，而外设的速度相对较慢（从计算机的角度来看）。因此，需要一个过渡区域，即内存。由于外设速度较慢，可以在CPU处理当前操作时，将接下来操作所需的数据提前存储到内存中。这种方式有效缩小了外设与CPU之间的速度差距，提高了计算机的整体效率。

## 操作系统

硬件规定了计算机的边界和下限，而软件则体现了计算机的上限。就像人体一样，我们有眼睛和双手，可以看电脑和敲键盘，但谁告诉眼睛去看电脑、手去敲键盘的呢？是“我”这个意识，因为我在进行某项活动。同样，计算机内部需要操作系统作为机制，将具体操作拆分为详细流程，指挥各个硬件执行相应任务，从而完成更复杂的操作。操作系统不仅管理硬件资源，还提供用户界面和应用程序之间的接口，使计算机能够高效运行。

![绘图1](https://md-wind.oss-cn-nanjing.aliyuncs.com/md/202410111425950.png)

通用计算机系统都包含一个基本的程序集合，称为操作系统（Operator System ），广义地说，操作系统包括两部分：

- 内核（进程管理，内存管理，文件管理，驱动管理）  
- 其他程序（例如函数库，shell程序等等）  

狭义地说，操作系统单指内核。

操作系统通过驱动操控硬件，每个硬件都有对应的驱动程序，操作系统无法越过驱动直接调用硬件资源。一般来说，都由操作系统自带。

操作系统对软硬件资源进行全面管理，包括内存、进程、文件和驱动等。为了保护操作系统本身，同时满足用户的需求，操作系统仅提供有限的接口供用户使用。这种设计减少了因用户操作导致系统损坏的可能性，同时仍能有效满足用户的需求。各种管理措施并不是目的，而是手段，最终目标是提升用户体验和满足用户需求。

用户不仅包括普通用户，还包括基于该操作系统的开发人员。操作系统为开发人员提供所需的各种支持，以便他们开发应用程序。开发人员则为操作系统创造良好的应用环境，满足更多普通用户的需求，从而促进操作系统的传播和普及。这种双向互动不仅增强了操作系统的生态系统，也推动了技术的进一步发展。

某些开发人员将系统调用接口进行封装，形成各种库、命令行解释器及部分指令。例如，`printf`函数在底层调用了特定的系统接口，以实现字符的打印控制。这种封装不仅简化了开发过程，还提高了代码的可重用性，使得开发人员能够更高效地与操作系统进行交互。由于操作系统本质上是使用如C/C++等高级语言编写的，因此系统调用接口的一种常见形式就是函数。这样就能减少开发人员的开发门槛，让系统接口以简洁的形式展现出来。

作为开发人员，我们学习操作系统的目的是了解其各种接口，从而编写出高质量的应用程序供他人使用。尽管计算机语言不断迭代，操作系统的基本原理却始终不变。因此，深入学习操作系统的知识对开发人员至关重要，这不仅能够提高应用程序的性能和稳定性，还能帮助我们更好地理解系统资源的管理与调度。

## 如何管理

从上述过程可以看出，操作系统为了向用户提供服务，需要对软硬件进行一系列的管理。接下来，我们详细探讨一下操作系统是如何进行管理的。

首先，从管理过程的角度来看，操作系统的管理可以分为两个主要步骤：信息收集和决策制定。我们可以通过一个生活中的例子来更好地理解这一点。以学校管理学生为例，学校首先会收集学生的个人信息，如日常表现和学习成绩。基于这些信息，学校做出相关决策，例如，对表现优秀的学生给予表扬或奖学金，而对挂科较多的学生进行辅导和沟通。

从管理对象的角度来看，管理涉及管理者与被管理者之间的互动。在学校里，校长是管理者，而学生是被管理者。校长需要通过一个系统化的流程来收集学生的信息，并依据这些信息做出决策。然而，校长并不是直接管理每一个学生，而是通过一系列中间层来实现管理。比如，当校长想要奖励优秀学生时，他首先与各学院的院长沟通，院长再通知辅导员，辅导员从各自的班级中选出优秀学生。经过层层筛选，最终校长获得一份优秀学生的名单。

这种管理方式被称为垂直式管理。垂直式管理让管理者能够掌握被管理对象的整体情况，而无需关注过多细节，从而可以管理更多的学生。中间层则充当执行者的角色，负责信息收集和执行管理者的决策。

从这个例子中，我们可以体会到管理的递归性质。对于某个角色来说，它既是管理者，又是被管理者。校长一方面要管理学生，另一方面又受政府教育机构的管理。此外，管理更多的是层与层之间的管理，而不仅仅是直接管理。

同样地，对于操作系统来说，它对软硬件资源的管理也不是直接进行的，而是通过一系列中间层来实现。操作系统首先通过这些中间层收集软硬件的具体信息，例如内存使用情况、CPU负载、外设状态等。然后，操作系统根据收集到的信息做出相应的决策，如内存分配、进程调度、输入输出管理等。最后，这些中间层会执行操作系统的决策，确保软硬件资源的高效利用和系统的稳定运行。这种间接管理方式使得操作系统能够在不直接干预每个细节的情况下，灵活地管理复杂的资源环境。

------------------------------

在操作系统中，如何有效地收集和管理软硬件资源的信息是一个关键问题，这实际上涉及到认识论的范畴，因此操作系统有时被称为计算机科学中的哲学。我们对某个对象的认识或描述，通常是通过该对象的一些属性来实现的。比如，描述一个人时，我们会用到姓名、出生日期、籍贯、联系方式等信息。同样，操作系统通过将各种软硬件资源抽象为具体的对象，并通过一系列属性（即数据）来描述这些对象。这些属性可能包括内存使用情况（如总内存、已用内存、可用内存）、CPU负载（如使用率、运行中的进程数）以及设备状态（如输入输出设备的连接状态、使用情况）。

由于计算机上存在众多软硬件资源，因此有许多需要管理的对象。为了有效地管理这些对象，操作系统使用各种算法和数据结构来组织这些对象。这些工具帮助操作系统在不同的层次上收集、存储和处理信息，从而做出明智的管理决策。例如，操作系统可能使用链表、队列或树形结构来管理进程调度，确保CPU的高效利用；使用哈希表来管理内存分配，快速查找和分配内存块，提高内存利用率；使用优先级队列来处理输入输出请求，根据任务的重要性和紧急程度安排处理顺序，从而提高系统响应速度。

总的来说，操作系统对软硬件资源的管理可以总结为六个字：先描述，再组织。这种方法使得操作系统能够在复杂的资源环境中灵活应对，不仅提高了资源利用率，还增强了系统的响应能力，确保系统的稳定性和性能。通过有效的描述和组织，操作系统能够高效地访问和更新资源信息，保持系统的高效运行。



# 完